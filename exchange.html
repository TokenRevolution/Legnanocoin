<html>
  <head>
    <title>Exchange LeganoCoin </title>
    <style>
      #rowbuy{
            height: auto;
            text-align: center;
            border: 1px solid black;
            width: 50%;
            margin-left: 25%;
            margin-top: 5%;
            margin-bottom: 5%;
            background: rgb(255 0 0 / 70%);
            border-radius: 20px;
      }
      #rowsell{
            height: auto;
            text-align: center;
            border: 1px solid black;
            width: 50%;
            margin-left: 25%;
            background: rgb(255 0 0 / 70%);
            border-radius: 20px;
      }
      #legnanotokensection{
      margin-top: 2.5%;
      margin-bottom: 2.5%;
      }
      #BUSDsection{
      margin-top: 2.5%;
      margin-bottom: 2.5%;
      }
      body {
      background-image: url(https://www.moomhotel.com/wp-content/uploads/2015/05/legnano1.jpg);
      background-repeat: no-repeat;
      }
    </style>
  </head>
  <body>
    
  <button class="enableEthereumButton btn">Enable Ethereum</button>
  <button class="showAccount">Show account</button>
  <button class="sendEthButton btn">BUY</button> 
    
    <div id="rowbuy">
            <div id="BUSDsection">
              <lable>Amount of BUSD:</lable>
              <input type="number" id="buy" value="0">
            </div>
            <div id="Legnanotokensection">
              <lable> You will have: <label type="number" id="BuyL">XXXX</label> LeganoCoin </lable>
              <br>
               <button>BUY</button>
            </div>
    </div>
    <div id="rowsell">
            <div id="Legnanotokensection">
              <lable>Amount of LegnanoCoin</lable>
              <input type="number" id="sell" value="0">
            </div>
            <div id="BUSDsection">
               <lable> You will have: <label type="number" id="SellL">XXXX</lable> BUSD </lable>
               <br>
               <button>SELL</button>
            </div>
    </div>
  
      <script>
const Buy = document.getElementById('Buy');
const BuyL = document.getElementById('BuyL');
const Sell = document.getElementById('Sell');
const SellL = document.getElementById('SellL');
Buy.addEventListener("change", function() {BuyL.innerHTML= Buy.value*1});
Sell.addEventListener("change", function() {SellL.innerHTML= Sell.value*1});
        
const ethereumButton = document.querySelector('.enableEthereumButton');
const sendEthButton = document.querySelector('.sendEthButton');
const showAccount = document.querySelector('.showAccount');

let accounts = [];

//Sending Ethereum to an address
sendEthButton.addEventListener('click', () => {
  ethereum
    .request({
      method: 'eth_sendTransaction',
      params: [
        {
          from: accounts[0],
          to: '0x2f318C334780961FB129D2a6c30D0763d9a5C970',
          value: '0x29a2241af62c0000',
          gasPrice: '0x09184e72a000',
          gas: '0x2710',
        },
      ],
    })
    .then((txHash) => console.log(txHash))
    .catch((error) => console.error);
});

ethereumButton.addEventListener('click', () => {
  getAccount();
});

async function getAccount() {
  accounts = await ethereum.request({ method: 'eth_requestAccounts' });
  const account = accounts[0];
  showAccount.innerHTML = account;
       try {
     handleNewAccounts(account);
    } catch (err) {
      console.error('Error on init when getting accounts', err);
    }
}
async function handleNewAccounts(newAccounts)
      {    
var SMART_CHAIN = "https://api.bscscan.com/api";
var ADDRESS_FOR_GET_BALANCE = "0xe9e7cea3dedca5984780bafc599bd69add087d56";
var CONNECTED_ADDRESS = newAccounts;
var APIKEY = "XHQ5VW16JQQBUESG69IBVACI83KEDAAMC2";
var DECIMALS_OF_CHOSED_TOKEN = 1e-18;
await $.getJSON(SMART_CHAIN + '?module=account&action=tokenbalance&contractaddress='+ADDRESS_FOR_GET_BALANCE+'&address='+CONNECTED_ADDRESS+'&tag=latest&apikey='+APIKEY, function (data) {
    let BALANCE = data['result'] * DECIMALS_OF_CHOSED_TOKEN;

  document.getElementById('Ntoken').innerHTML = BALANCE;
  });
      } 
    </script>
  </body>
</html>
